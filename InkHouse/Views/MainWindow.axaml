<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:InkHouse.ViewModels"
        xmlns:local="clr-namespace:InkHouse.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="InkHouse.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="InkHouse - å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ"
        Width="1200" Height="800"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <local:MenuCheckedConverter x:Key="MenuCheckedConverter"/>
        <local:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ä¾§è¾¹æ  -->
        <Border Classes="sidebar" Grid.Column="0">
            <DockPanel Margin="16">
                <!-- é¡¶éƒ¨åŒºåŸŸ -->
                <StackPanel DockPanel.Dock="Top" HorizontalAlignment="Stretch">
                <TextBlock Classes="title" Text="InkHouse" Margin="0,0,0,32"/>
                    <StackPanel Classes="nav-group" Spacing="8" HorizontalAlignment="Stretch">
                        <RadioButton GroupName="Menu" Content="ðŸ ä»ªè¡¨æ¿" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=Dashboard}" Command="{Binding ShowDashboardCommand}" HorizontalAlignment="Stretch"/>
                        <RadioButton GroupName="Menu" Content="ðŸ“šå›¾ä¹¦ç®¡ç†" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=BookManagement}" Command="{Binding ShowBookManagementCommand}" HorizontalAlignment="Stretch"/>
                        <RadioButton GroupName="Menu" Content="ðŸ‘¤ç”¨æˆ·ç®¡ç†" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=UserManagement}" Command="{Binding ShowUserManagementCommand}" HorizontalAlignment="Stretch"/>
                        <RadioButton GroupName="Menu" Content="ðŸ“å€Ÿé˜…ç®¡ç†" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=BorrowManagement}" Command="{Binding ShowBorrowManagementCommand}" HorizontalAlignment="Stretch"/>
                        <RadioButton GroupName="Menu" Content="ðŸ“Šç»Ÿè®¡åˆ†æž" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=Statistics}" Command="{Binding ShowStatisticsCommand}" HorizontalAlignment="Stretch"/>
                        <RadioButton GroupName="Menu" Content="âš™ï¸ç³»ç»Ÿè®¾ç½®" IsChecked="{Binding SelectedMenu, Converter={StaticResource MenuCheckedConverter}, ConverterParameter=Settings}" Command="{Binding ShowSettingsCommand}" HorizontalAlignment="Stretch"/>
                    </StackPanel>
                </StackPanel>
                <!-- åº•éƒ¨åŒºåŸŸ -->
                <StackPanel DockPanel.Dock="Bottom" Spacing="16" HorizontalAlignment="Stretch">
                    <Rectangle Classes="divider"/>
                    <StackPanel HorizontalAlignment="Stretch">
                    <TextBlock Classes="caption" Text="å½“å‰ç”¨æˆ·"/>
                    <TextBlock Classes="label" Text="ç®¡ç†å‘˜" FontWeight="600"/>
                        <Button Classes="danger" Content="ðŸšª é€€å‡ºç™»å½•" Margin="0,8,0,0" HorizontalAlignment="Stretch" MinWidth="0" Command="{Binding LogoutCommand}"/>
                    </StackPanel>
                </StackPanel>
                <!-- ä¸­é—´å¡ç‰‡åŒºåŸŸ -->
                <Border Classes="card" VerticalAlignment="Bottom" Margin="0,24,0,0" Padding="20">
                    <StackPanel Spacing="8" HorizontalAlignment="Stretch">
                        <TextBlock Classes="label" Text="æœ€è¿‘å€Ÿé˜…è®°å½•" FontWeight="Bold"/>
                        <ItemsControl ItemsSource="{Binding RecentBorrowRecords}" IsVisible="{Binding HasRecentBorrowRecords}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Classes="caption" Text="{Binding Book.Title, StringFormat=ã€Š{0}ã€‹}  {Binding User.UserName}  {Binding BorrowDate, StringFormat=yyyy-MM-dd}" TextWrapping="Wrap"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <TextBlock Classes="caption" Text="æš‚æ— å€Ÿé˜…è®°å½•" IsVisible="{Binding HasRecentBorrowRecords, Converter={StaticResource InverseBooleanConverter}}"/>
                        <Button Classes="success" Content="æŸ¥çœ‹" HorizontalAlignment="Stretch" Command="{Binding ShowBorrowManagementCommand}"/>
            </StackPanel>
                </Border>
            </DockPanel>
        </Border>
        <!-- ä¸»å†…å®¹åŒº -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
            <Border Classes="navbar" Grid.Row="0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Classes="subtitle" Text="{Binding SelectedMenu}" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="12">
                        <TextBox Classes="search" Watermark="æœç´¢..." Width="300"/>
                        <Button Classes="tool" Content="ðŸ””"/>
                        <Button Classes="tool" Content="âš™ï¸"/>
                    </StackPanel>
                </Grid>
            </Border>
            <!-- ä¸»è¦å†…å®¹ -->
            <ContentControl Grid.Row="1" Content="{Binding CurrentView}" Name="MainContentControl"/>
        </Grid>
    </Grid>
</Window>
